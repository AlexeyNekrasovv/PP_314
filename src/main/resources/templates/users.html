<!DOCTYPE html>
<html lang="ru" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
<!-- Navbar -->
<nav class="navbar" style="display: flex; justify-content: space-between; align-items: center;">
    <div style="display: flex; align-items: center; gap: 1rem;">
        <div style="font-weight: 600; font-size: 1.125rem; color: var(--text-light);">
            <svg style="width: 24px; height: 24px; display: inline-block; vertical-align: middle; margin-right: 0.5rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
            Admin Panel
        </div>
    </div>
    <div class="user-info">
        <span id="currentUserEmail" style="font-weight: 500;"></span>
        <span class="badge" id="currentUserRole"></span>
        <a href="/logout" class="nav-link" style="margin-left: 1rem; background: rgba(255,255,255,0.1); padding: 0.5rem 1rem !important; border-radius: var(--radius);">
            <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 0.25rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            Logout
        </a>
    </div>
</nav>

<div style="display: flex;">
    <!-- Sidebar -->
    <div class="sidebar" style="width: 220px;">
        <nav>
            <a href="/admin" class="nav-link active">
                <svg style="width: 18px; height: 18px; display: inline-block; vertical-align: middle; margin-right: 0.5rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                Admin
            </a>
            <a href="/user" class="nav-link">
                <svg style="width: 18px; height: 18px; display: inline-block; vertical-align: middle; margin-right: 0.5rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                User
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content" style="flex: 1;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <div>
                <h2 style="margin-bottom: 0.25rem;">User Management</h2>
                <p style="color: var(--text-secondary); font-size: 0.875rem;">Manage system users and their roles</p>
            </div>
            <button onclick="openModal('newUserPopup')" class="btn btn-primary">
                <svg style="width: 18px; height: 18px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                </svg>
                Add User
            </button>
        </div>

        <!-- Users Table -->
        <div class="card">
            <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                <span>All Users</span>
                <span id="user-count" style="color: var(--text-secondary); font-size: 0.875rem; font-weight: 400;"></span>
            </div>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Age</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th style="width: 120px; text-align: right;">Actions</th>
                </tr>
                </thead>
                <tbody id="users-table-body">
                <!-- Data loaded via JS -->
                </tbody>
            </table>
            <div id="empty-state" class="empty-state" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
                </svg>
                <h3>No users found</h3>
                <p>Get started by adding your first user</p>
            </div>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toast-container"></div>

<!-- Overlay -->
<div id="overlay" class="overlay"></div>

<!-- Add User Modal -->
<div id="newUserPopup" class="popup">
    <div class="popup-header">
        <h3>Add New User</h3>
        <a href="#" class="close-popup" data-modal="newUserPopup">&times;</a>
    </div>
    <div class="popup-body">
        <form id="new-user-form">
            <div class="form-group">
                <label for="firstName">First Name</label>
                <input type="text" class="form-control" id="firstName" name="firstName" required>
            </div>
            <div class="form-group">
                <label for="lastName">Last Name</label>
                <input type="text" class="form-control" id="lastName" name="lastName" required>
            </div>
            <div class="form-group">
                <label for="age">Age</label>
                <input type="number" class="form-control" id="age" name="age" required>
            </div>
            <div class="form-group">
                <label for="newEmail">Email</label>
                <input type="email" class="form-control" id="newEmail" name="email" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" name="password" required>
            </div>
            <div class="form-group">
                <label for="roles">Roles</label>
                <select class="form-control" multiple id="roles" name="roles"></select>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Create User</button>
        </form>
    </div>
</div>

<!-- Edit User Modal -->
<div id="editUserModal" class="popup">
    <div class="popup-header">
        <h3>Edit User</h3>
        <a href="#" class="close-popup" data-modal="editUserModal">&times;</a>
    </div>
    <div class="popup-body">
        <form id="editUserForm">
            <input type="hidden" id="editUserId" name="id">
            <div class="form-group">
                <label for="editFirstName">First Name</label>
                <input type="text" class="form-control" id="editFirstName" name="editFirstName" required>
            </div>
            <div class="form-group">
                <label for="editLastName">Last Name</label>
                <input type="text" class="form-control" id="editLastName" name="editLastName" required>
            </div>
            <div class="form-group">
                <label for="editAge">Age</label>
                <input type="number" class="form-control" id="editAge" name="editAge" required>
            </div>
            <div class="form-group">
                <label for="editEmail">Email</label>
                <input type="email" class="form-control" id="editEmail" name="editEmail" required>
            </div>
            <div class="form-group">
                <label for="editRoles">Roles</label>
                <select multiple class="form-control" id="editRoles" name="editRoles"></select>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Save Changes</button>
        </form>
    </div>
</div>

<script src="/js/users.js"></script>
</body>
</html>